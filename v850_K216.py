import idc
import idaapi
import idautils	

#gp=0xFEE05328  +FFFF0000=FEDF5328
#sp=0xFEDFDB7C
def V850():
	AddSeg(0xFFFF7000 , 0xFFFF8000, 0, 1, 1, 2)
        RenameSeg(0xFFFF7000, "DMAC")
        AddSeg(0xFFFF6000 , 0xFFFF7000, 0, 1, 1, 2)
        RenameSeg(0xFFFF6000, "INTC")
        AddSeg(0xFF400000 , 0xFF840000, 0, 1, 1, 2)
        RenameSeg(0xFF400000, "PBUS")
        AddSeg(0xFE000000 , 0xFE008000, 0, 1, 1, 2)
        RenameSeg(0xFE000000, "Data flash")

def init1():
        AddSeg(0xFEDFC800 , 0xFEDFD380, 0, 1, 1, 2)
        MakeUnknown(0xFEDFC800, 0xFEDFD380-0xFEDFC800, DOUNK_SIMPLE)
        RenameSeg(0xFEDFC800, "Data_Ram")
	dst  = 0xFEDFC800
	src = 0x4548
	i=0
	while i < 0x44:
                PatchByte(dst+i,Dword(src+i))
                i=i+1
def init2():
        AddSeg(0xFEDFA000 ,  0xFEDFE500, 0, 1, 1, 2)
        MakeUnknown(0xFEDFA000, 0xFEDFE500-0xFEDFA000, DOUNK_SIMPLE)
        RenameSeg(0xFEDFA000, "Data_Ram")
	dst  = 0xFEDFA000
	src = 0x4EC50
	i=0
	while i < 0xD24:
                PatchByte(dst+i,Dword(src+i))
                i=i+1
        
def memset(start,value,size):
        i=0
        while i < size:
             PatchByte(start+i,value)
             i=i+1

def makeFCN0():
        MakeName(0xFF480000+0x00008, "FCN0GMCSPRE")
        MakeName(0xFF480000+0x00020, "FCN0GMADCTL")
        MakeName(0xFF480000+0x00248, "FCN0CMLCSTR")
        MakeName(0xFF480000+0x0024C, "FCN0CMINSTR")
        MakeName(0xFF480000+0x00268, "FCN0CMBRPRS")
        MakeName(0xFF480000+0x00278, "FCN0CMLISTR")
        MakeName(0xFF480000+0x00288, "FCN0CMLOSTR")
        MakeName(0xFF480000+0x08000, "FCN0GMCLCTL")
        MakeName(0xFF480000+0x08018, "FCN0GMABCTL")
        MakeName(0xFF480000+0x08240, "FCN0CMCLCTL")
        MakeName(0xFF480000+0x08250, "FCN0CMERCNT")
        MakeName(0xFF480000+0x08258, "FCN0CMIECTL")
        MakeName(0xFF480000+0x08260, "FCN0CMISCTL")
        MakeName(0xFF480000+0x08270, "FCN0CMBTCTL")
        MakeName(0xFF480000+0x08280, "FCN0CMRGRX")
        MakeName(0xFF480000+0x08290, "FCN0CMTGTX")
        MakeName(0xFF480000+0x08298, "FCN0CMTSCTL")
        MakeName(0xFF480000+0x08300, "FCN0CMMKCTL01H")
        MakeName(0xFF480000+0x08308, "FCN0CMMKCTL02H")
        MakeName(0xFF480000+0x10300, "FCN0CMMKCTL01W")
        MakeName(0xFF480000+0x08310, "FCN0CMMKCTL03H")
        MakeName(0xFF480000+0x08318, "FCN0CMMKCTL04H")
        MakeName(0xFF480000+0x08320, "FCN0CMMKCTL05H")
        MakeName(0xFF480000+0x08328, "FCN0CMMKCTL06H")
        MakeName(0xFF480000+0x08330, "FCN0CMMKCTL07H")
        MakeName(0xFF480000+0x08338, "FCN0CMMKCTL08H")
        MakeName(0xFF480000+0x08340, "FCN0CMMKCTL09H")
        MakeName(0xFF480000+0x08348, "FCN0CMMKCTL10H")
        MakeName(0xFF480000+0x08350, "FCN0CMMKCTL11H")
        MakeName(0xFF480000+0x08358, "FCN0CMMKCTL12H")
        MakeName(0xFF480000+0x08360, "FCN0CMMKCTL13H")
        MakeName(0xFF480000+0x08368, "FCN0CMMKCTL14H")
        MakeName(0xFF480000+0x08370, "FCN0CMMKCTL15H")
        MakeName(0xFF480000+0x08378, "FCN0CMMKCTL16H")
        MakeName(0xFF480000+0x100C0, "FCN0DNBMRX0")
        MakeName(0xFF480000+0x100D0, "FCN0DNBMRX1")
        MakeName(0xFF480000+0x100E0, "FCN0DNBMRX2")
        MakeName(0xFF480000+0x100F0, "FCN0DNBMRX3")
        MakeName(0xFF480000+0x10310, "FCN0CMMKCTL03W")
        MakeName(0xFF480000+0x10320, "FCN0CMMKCTL05W")
        MakeName(0xFF480000+0x10330, "FCN0CMMKCTL07W")
        MakeName(0xFF480000+0x10340, "FCN0CMMKCTL09W")
        MakeName(0xFF480000+0x10350, "FCN0CMMKCTL11W")
        MakeName(0xFF480000+0x10360, "FCN0CMMKCTL13W")
        MakeName(0xFF480000+0x10370, "FCN0CMMKCTL15W")
        
def makeFCN1():
        MakeName(0xFF4A0000+0x00008, "FCN1GMCSPRE")
        MakeName(0xFF4A0000+0x00020, "FCN1GMADCTL")
        MakeName(0xFF4A0000+0x00248, "FCN1CMLCSTR")
        MakeName(0xFF4A0000+0x0024C, "FCN1CMINSTR")
        MakeName(0xFF4A0000+0x00268, "FCN1CMBRPRS")
        MakeName(0xFF4A0000+0x00278, "FCN1CMLISTR")
        MakeName(0xFF4A0000+0x00288, "FCN1CMLOSTR")
        MakeName(0xFF4A0000+0x08000, "FCN1GMCLCTL")
        MakeName(0xFF4A0000+0x08018, "FCN1GMABCTL")
        MakeName(0xFF4A0000+0x08240, "FCN1CMCLCTL")
        MakeName(0xFF4A0000+0x08250, "FCN1CMERCNT")
        MakeName(0xFF4A0000+0x08258, "FCN1CMIECTL")
        MakeName(0xFF4A0000+0x08260, "FCN1CMISCTL")
        MakeName(0xFF4A0000+0x08270, "FCN1CMBTCTL")
        MakeName(0xFF4A0000+0x08280, "FCN1CMRGRX")
        MakeName(0xFF4A0000+0x08290, "FCN1CMTGTX")
        MakeName(0xFF4A0000+0x08298, "FCN1CMTSCTL")
        MakeName(0xFF4A0000+0x08300, "FCN1CMMKCTL01H")
        MakeName(0xFF4A0000+0x08308, "FCN1CMMKCTL02H")
        MakeName(0xFF4A0000+0x10300, "FCN1CMMKCTL01W")
        MakeName(0xFF4A0000+0x08310, "FCN1CMMKCTL03H")
        MakeName(0xFF4A0000+0x08318, "FCN1CMMKCTL04H")
        MakeName(0xFF4A0000+0x08320, "FCN1CMMKCTL05H")
        MakeName(0xFF4A0000+0x08328, "FCN1CMMKCTL06H")
        MakeName(0xFF4A0000+0x08330, "FCN1CMMKCTL07H")
        MakeName(0xFF4A0000+0x08338, "FCN1CMMKCTL08H")
        MakeName(0xFF4A0000+0x08340, "FCN1CMMKCTL09H")
        MakeName(0xFF4A0000+0x08348, "FCN1CMMKCTL10H")
        MakeName(0xFF4A0000+0x08350, "FCN1CMMKCTL11H")
        MakeName(0xFF4A0000+0x08358, "FCN1CMMKCTL12H")
        MakeName(0xFF4A0000+0x08360, "FCN1CMMKCTL13H")
        MakeName(0xFF4A0000+0x08368, "FCN1CMMKCTL14H")
        MakeName(0xFF4A0000+0x08370, "FCN1CMMKCTL15H")
        MakeName(0xFF4A0000+0x08378, "FCN1CMMKCTL16H")
        MakeName(0xFF4A0000+0x100C0, "FCN1DNBMRX0")
        MakeName(0xFF4A0000+0x100D0, "FCN1DNBMRX1")
        MakeName(0xFF4A0000+0x100E0, "FCN1DNBMRX2")
        MakeName(0xFF4A0000+0x100F0, "FCN1DNBMRX3")
        MakeName(0xFF4A0000+0x10310, "FCN1CMMKCTL03W")
        MakeName(0xFF4A0000+0x10320, "FCN1CMMKCTL05W")
        MakeName(0xFF4A0000+0x10330, "FCN1CMMKCTL07W")
        MakeName(0xFF4A0000+0x10340, "FCN1CMMKCTL09W")
        MakeName(0xFF4A0000+0x10350, "FCN1CMMKCTL11W")
        MakeName(0xFF4A0000+0x10360, "FCN1CMMKCTL13W")
        MakeName(0xFF4A0000+0x10370, "FCN1CMMKCTL15W")

def makeinterrupt():
        MakeName(0x0080, "INTWDTA0")
        MakeName(0x0090, "INTWDTA1")
        MakeName(0x00A0, "INTLVI")
        MakeName(0x0110, "INTP0")
        MakeName(0x0120, "INTP1")
        MakeName(0x0130, "INTP2")
        MakeName(0x0140, "INTP3")
        MakeName(0x0150, "INTP4")
        MakeName(0x0160, "INTP5")
        MakeName(0x0170, "INTP6")
        MakeName(0x0180, "INTP7")
        MakeName(0x0190, "INTP8")
        MakeName(0x01A0, "INTP9")
        MakeName(0x01C0, "INTTAUB0I0")
        MakeName(0x01D0, "INTTAUB0I1")
        MakeName(0x01E0, "INTTAUB0I2")
        MakeName(0x01F0, "INTTAUB0I3")
        MakeName(0x0200, "INTTAUB0I4")
        MakeName(0x0210, "INTTAUB0I5")
        MakeName(0x0220, "INTTAUB0I6")
        MakeName(0x0230, "INTTAUB0I7")
        MakeName(0x0240, "INTTAUB0I8")
        MakeName(0x0250, "INTTAUB0I9")
        MakeName(0x0260, "INTTAUB0I10")
        MakeName(0x0270, "INTTAUB0I11")
        MakeName(0x0280, "INTTAUB0I12")
        MakeName(0x0290, "INTTAUB0I13")
        MakeName(0x02A0, "INTTAUB0I14")
        MakeName(0x02B0, "INTTAUB0I15")
        MakeName(0x03C0, "INTADAA0ERR")
        MakeName(0x03D0, "INTADAA0I0")
        MakeName(0x03E0, "INTADAA0I1")
        MakeName(0x03F0, "INTADAA0I2")
        MakeName(0x0400, "INTADAA0LLT")
        MakeName(0x0410, "INTFCNWUP")
        MakeName(0x0440, "INTFCN0ERR")
        MakeName(0x0450, "INTFCN0REC")
        MakeName(0x0460, "INTFCN0TRX")
        MakeName(0x0470, "INTCSIG0IRE")
        MakeName(0x0480, "INTCSIG0IR")
        MakeName(0x0490, "INTCSIG0IC")
        MakeName(0x04A0, "INTDMA0")
        MakeName(0x04B0, "INTDMA1")
        MakeName(0x04C0, "INTDMA2")
        MakeName(0x04D0, "INTDMA3")
        MakeName(0x04E0, "INTDMA4")
        MakeName(0x04F0, "INTDMA5")
        MakeName(0x0500, "INTDMA6")
        MakeName(0x0510, "INTDMA7")
        MakeName(0x0520, "INTIICB0IA")
        MakeName(0x0530, "INTFCN1ERR")
        MakeName(0x0540, "INTFCN1REC")
        MakeName(0x0550, "INTFCN1TRX")
        MakeName(0x0560, "INTTAUJ0I0")
        MakeName(0x0570, "INTTAUJ0I1")
        MakeName(0x0580, "INTTAUJ0I2")
        MakeName(0x0590, "INTTAUJ0I3")
        MakeName(0x05A0, "INTOSTM0")
        MakeName(0x05B0, "INTCSIG4IRE")
        MakeName(0x05C0, "INTCSIG4IR")
        MakeName(0x05D0, "INTCSIG4IC")
        MakeName(0x0610, "INTLMA2IS")
        MakeName(0x0620, "INTLMA2IR")
        MakeName(0x0630, "INTLMA2IT")
        MakeName(0x06A0, "INTCSIG7IRE")
        MakeName(0x06B0, "INTCSIG7IR")
        MakeName(0x06C0, "INTCSIG7IC")
        MakeName(0x06D0, "INTP11")
        MakeName(0x06E0, "INTP12")
        MakeName(0x0720, "INTKR0")
        MakeName(0x0730, "INTLMAAIS")
        MakeName(0x0740, "INTLMAAIR")
        MakeName(0x0750, "INTLMAAIT")
        MakeName(0x0760, "INTLMABIS")
        MakeName(0x0770, "INTLMABIR")
        MakeName(0x0780, "INTLMABIT")
        MakeCode(0x0080)
        MakeCode(0x0090)
        MakeCode(0x00A0)
        MakeCode(0x0110)
        MakeCode(0x0120)
        MakeCode(0x0130)
        MakeCode(0x0140)
        MakeCode(0x0150)
        MakeCode(0x0160)
        MakeCode(0x0170)
        MakeCode(0x0180)
        MakeCode(0x0190)
        MakeCode(0x01A0)
        MakeCode(0x01C0)
        MakeCode(0x01D0)
        MakeCode(0x01E0)
        MakeCode(0x01F0)
        MakeCode(0x0200)
        MakeCode(0x0210)
        MakeCode(0x0220)
        MakeCode(0x0230)
        MakeCode(0x0240)
        MakeCode(0x0250)
        MakeCode(0x0260)
        MakeCode(0x0270)
        MakeCode(0x0280)
        MakeCode(0x0290)
        MakeCode(0x02A0)
        MakeCode(0x02B0)
        MakeCode(0x03C0)
        MakeCode(0x03D0)
        MakeCode(0x03E0)
        MakeCode(0x03F0)
        MakeCode(0x0400)
        MakeCode(0x0410)
        MakeCode(0x0440)
        MakeCode(0x0450)
        MakeCode(0x0460)
        MakeCode(0x0470)
        MakeCode(0x0480)
        MakeCode(0x0490)
        MakeCode(0x04A0)
        MakeCode(0x04B0)
        MakeCode(0x04C0)
        MakeCode(0x04D0)
        MakeCode(0x04E0)
        MakeCode(0x04F0)
        MakeCode(0x0500)
        MakeCode(0x0510)
        MakeCode(0x0520)
        MakeCode(0x0530)
        MakeCode(0x0540)
        MakeCode(0x0550)
        MakeCode(0x0560)
        MakeCode(0x0570)
        MakeCode(0x0580)
        MakeCode(0x0590)
        MakeCode(0x05A0)
        MakeCode(0x05B0)
        MakeCode(0x05C0)
        MakeCode(0x05D0)
        MakeCode(0x0610)
        MakeCode(0x0620)
        MakeCode(0x0630)
        MakeCode(0x06A0)
        MakeCode(0x06B0)
        MakeCode(0x06C0)
        MakeCode(0x06D0)
        MakeCode(0x06E0)
        MakeCode(0x0720)
        MakeCode(0x0730)
        MakeCode(0x0740)
        MakeCode(0x0750)
        MakeCode(0x0760)
        MakeCode(0x0770)
        MakeCode(0x0780)

def makeCSIG():
        MakeName(0xFF700000, "CSIG0_CSIGnCTL0")
        MakeName(0xFF700010, "CSIG0_CSIGnCTL1")
        MakeName(0xFF700014, "CSIG0_CSIGnCTL2")
        MakeName(0xFF700004, "CSIG0_CSIGnSTR0")
        MakeName(0xFF700008, "CSIG0_CSIGnSTCR0")
        MakeName(0xFF701000, "CSIG0_CSIGnBCTL0")
        MakeName(0xFF701010, "CSIG0_CSIGnCFG0")
        MakeName(0xFF701004, "CSIG0_CSIGnTX0W")
        MakeName(0xFF701008, "CSIG0_CSIGnTX0H")
        MakeName(0xFF70100C, "CSIG0_CSIGnRX0")
        MakeName(0xFF700018, "CSIG0_CSIGnEMU")
        MakeName(0xFF740000, "CSIG4_CSIGnCTL0")
        MakeName(0xFF740010, "CSIG4_CSIGnCTL1")
        MakeName(0xFF740014, "CSIG4_CSIGnCTL2")
        MakeName(0xFF740004, "CSIG4_CSIGnSTR0")
        MakeName(0xFF740008, "CSIG4_CSIGnSTCR0")
        MakeName(0xFF741000, "CSIG4_CSIGnBCTL0")
        MakeName(0xFF741010, "CSIG4_CSIGnCFG0")
        MakeName(0xFF741004, "CSIG4_CSIGnTX0W")
        MakeName(0xFF741008, "CSIG4_CSIGnTX0H")
        MakeName(0xFF74100C, "CSIG4_CSIGnRX0")
        MakeName(0xFF740018, "CSIG4_CSIGnEMU")
        MakeName(0xFF690000, "CSIG7_CSIGnCTL0")
        MakeName(0xFF690010, "CSIG7_CSIGnCTL1")
        MakeName(0xFF690014, "CSIG7_CSIGnCTL2")
        MakeName(0xFF690004, "CSIG7_CSIGnSTR0")
        MakeName(0xFF690008, "CSIG7_CSIGnSTCR0")
        MakeName(0xFF691000, "CSIG7_CSIGnBCTL0")
        MakeName(0xFF691010, "CSIG7_CSIGnCFG0")
        MakeName(0xFF691004, "CSIG7_CSIGnTX0W")
        MakeName(0xFF691008, "CSIG7_CSIGnTX0H")
        MakeName(0xFF69100C, "CSIG7_CSIGnRX0")
        MakeName(0xFF690018, "CSIG7_CSIGnEMU")

def makelong(start,end):
	MakeUnknown(start, end-start, idaapi.DOUNK_SIMPLE)
	ea  = start
	while ea < end:
		MakeDword(ea)
                ea=ea+4

def makeURTE():
        MakeName(0xFF5E0000, "URTE2_URTEnCTL0")
        MakeName(0xFF5E0020, "URTE2_URTEnCTL1")
        MakeName(0xFF5E0024, "URTE2_URTEnCTL2")
        MakeName(0xFF5E0004, "URTE2_URTEnTRG")
        MakeName(0xFF5E0008, "URTE2_URTEnSTR0")
        MakeName(0xFF5E000C, "URTE2_URTEnSTR1")
        MakeName(0xFF5E0010, "URTE2_URTEnSTC")
        MakeName(0xFF5E0014, "URTE2_URTEnRX")
        MakeName(0xFF5E0018, "URTE2_URTEnTX")
        MakeName(0xFF5E0034, "URTE2_URTEnEMU")
        MakeName(0xFF660000, "URTE10_URTEnCTL0")
        MakeName(0xFF660020, "URTE10_URTEnCTL1")
        MakeName(0xFF660024, "URTE10_URTEnCTL2")
        MakeName(0xFF660004, "URTE10_URTEnTRG")
        MakeName(0xFF660008, "URTE10_URTEnSTR0")
        MakeName(0xFF66000C, "URTE10_URTEnSTR1")
        MakeName(0xFF660010, "URTE10_URTEnSTC")
        MakeName(0xFF660014, "URTE10_URTEnRX")
        MakeName(0xFF660018, "URTE10_URTEnTX")
        MakeName(0xFF660034, "URTE10_URTEnEMU")
        MakeName(0xFF670000, "URTE11_URTEnCTL0")
        MakeName(0xFF670020, "URTE11_URTEnCTL1")
        MakeName(0xFF670024, "URTE11_URTEnCTL2")
        MakeName(0xFF670004, "URTE11_URTEnTRG")
        MakeName(0xFF670008, "URTE11_URTEnSTR0")
        MakeName(0xFF67000C, "URTE11_URTEnSTR1")
        MakeName(0xFF670010, "URTE11_URTEnSTC")
        MakeName(0xFF670014, "URTE11_URTEnRX")
        MakeName(0xFF670018, "URTE11_URTEnTX")
        MakeName(0xFF670034, "URTE11_URTEnEMU")
        
def main():
        V850()

        init1()
        init2()
        memset(0xFEDFAD24,0,0x37D4)
        makeFCN0()
        makeFCN1()
        makeinterrupt()
        makeURTE()
        #CSIG
        makeCSIG()
        #makelong(0x4EC50,0x4F974)
        #makelong(0x10D18,0x10F04)
        #makelong(0x12040,0x121E0)
        #makelong(0x12A28,0x12BC0)
        #makelong(0x157B4,0x186B8)
        
        

if __name__ == '__main__':
	main()
